
<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–¢–∞–±–ª–∏—Ü—è –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ –∫–ª—É–±—É "–Ø–©–Ü–†–ö–ê"</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f9f9f9;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1, h2 {
      color: #2c3e50;
      text-align: center;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    .clock {
      font-size: 3em;
      font-weight: bold;
      color: #2c3e50;
    }
    table {
      width: 100%;
      border-collapse: separate; /* –ó–º—ñ–Ω–µ–Ω–æ –∑ collapse –Ω–∞ separate –¥–ª—è —Ä–æ–±–æ—Ç–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏ */
      border-spacing: 0; /* –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥—Å—Ç—É–ø–∏ –º—ñ–∂ –∫–ª—ñ—Ç–∏–Ω–∫–∞–º–∏ –Ω–∞ 0 */
      margin-bottom: 20px;
      table-layout: fixed;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 4px;
      text-align: center;
      font-size: 1em;
    }
    th {
      border: 2px solid rebeccapurple;
      border-radius: 20px;
      background-color: #3498db;
      color: rgb(10, 9, 9);
      position: sticky;
      top: 0;
      z-index: 10; /* –î–æ–¥–∞—î–º–æ z-index –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ */
    }
    /* –°—Ç–∏–ª—ñ –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –ø–µ—Ä—à–æ—ó –∫–æ–ª–æ–Ω–∫–∏ */
    .name-column {
      width: 150px;
      position: sticky;
      left: 0;
      background-color: white; /* –ó–∞–¥–Ω—ñ–π —Ñ–æ–Ω –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏ */
      z-index: 5; /* –í–∏—â–∏–π z-index –¥–ª—è –ø–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è —ñ–Ω—à–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ */
    }
    th.name-column {
      border: 2px solid red;
      border-radius: 20px;
      background-color: #3498db; /* –ö–æ–ª—ñ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏ */
      z-index: 15; /* –í–∏—â–∏–π z-index –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
    }
    .day-column {
      width: 30px;
    }
    .total-column, .payment-column, .balance-column {
      width: 70px;
      background-color: #c6eb7d;
    }
    input[type="text"] {
      font-size: 20px;
      border-radius: 1cap;
      width: 95%;
      padding: 5px;
      border: 1px solid #271b48;
      border-radius: 4px;
      background-color: #c6eb7d;
    }
    input[type="number"] {
      width: 95%;
      padding: 5px;
      border: 1px solid #d622b5;
      border-radius: 20px;
      text-align: center;
      background-color: #d5c2c3;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
      cursor: pointer;
    }
    .weekend {
      background-color: #ebeb49;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #2980b9;
    }
    .button-group {
      display: flex;
      justify-content: center;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    .calculator {
      background-color: #eaf2f8;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .calculator table {
      margin-bottom: 0;
    }
    .month-selector {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
    }
    .month-selector select {
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ddd;
      margin-left: 10px;
      font-size: 2em;
    }
    .table-container {
      overflow-x: auto;
      margin-top: 20px;
      position: relative; /* –î–æ–¥–∞—î–º–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ */
    }
    .hidden-day {
      display: none;
    }
    .summary-container {
      background-color: #e8f8f5;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .summary-container table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 0;
    }
    .summary-container th {
      
      border-radius: 20px;
      background-color: #c37e0e;
      color: rgb(24, 23, 23);
    }
    .summary-container td {
      border: 5px solid #243e46;
      text-align: center;
      font-weight: bold;
      font-size: 1.1em;
    }
    /* –î–æ–¥–∞—î–º–æ —Ç—ñ–Ω—å –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏, —â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏, —â–æ –≤–æ–Ω–∞ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ */
    .name-column {
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }
    /* –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∏–ª—å –¥–ª—è –∫–æ–º—ñ—Ä–æ–∫ –∑ —ñ–º–µ–Ω–∞–º–∏ —É —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ–π –∫–æ–ª–æ–Ω—Ü—ñ */
    .name-cell {
      background-color: white;
      position: sticky;
      left: 0;
      z-index: 5;
    }
    .dateDisplay {
background-color: #b92935;
    }
    /* –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ */
@media (max-width: 768px) {
  .container {
    padding: 10px;
    margin: 10px 5px;
    width: 98%;
  }
  
  h1 {
    font-size: 1.5em;
  }
  
  h2, h3 {
    font-size: 1.3em;
  }
  
  .header {
    flex-direction: column;
    gap: 10px;
    padding-bottom: 5px;
  }
  
  .clock {
    font-size: 1.5em;
    margin: 0 auto;
  }
  
  #dateDisplay {
    font-size: 1em;
    padding: 6px;
  }
  
  /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –º—ñ—Å—è—Ü—è */
  .month-selector {
    flex-direction: column;
    gap: 5px;
  }
  
  .month-selector select,
  .month-selector input[type="number"] {
    width: 100%;
    max-width: 250px;
    font-size: 1em;
  }
  
  /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
  .calculator {
    flex-direction: column;
    padding: 10px;
  }
  
  .calculator input {
    width: 100%;
    max-width: 200px;
  }
  
  /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
  .button-group {
    flex-direction: column;
    width: 100%;
  }
  
  button {
    width: 100%;
    padding: 12px;
    font-size: 1em;
    margin-bottom: 5px;
  }
  
  /* –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ */
  .table-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch; /* –ü–ª–∞–≤–Ω–∏–π —Å–∫—Ä–æ–ª –Ω–∞ iOS */
    max-width: 100%;
    overflow-y: visible;
  }
  
  table {
    min-width: 500px; /* –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —à–∏—Ä–∏–Ω–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –Ω–∞–¥—Ç–æ —Å—Ç–∏—Å–Ω—É—Ç–∏—Ö –¥–∞–Ω–∏—Ö */
  }
  
  th, td {
    padding: 6px 2px;
    font-size: 0.9em;
  }
  
  .name-column {
    width: 120px;
  }
  
  .day-column {
    width: 30px;
  }
  
  .total-column, .payment-column, .balance-column {
    width: 60px;
  }
  
  input[type="text"],
  input[type="number"] {
    padding: 6px 2px;
    font-size: 0.9em;
  }
  
  /* –°—Ç–∏–ª—ñ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
  .modal-content {
    width: 95%;
    margin: 10% auto;
    padding: 15px;
  }
  
  .modal-title {
    font-size: 1.2em;
  }
  
  /* –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö –µ–∫—Ä–∞–Ω–∞—Ö */
  .summary-container td,
  .summary-container th {
    padding: 8px 4px;
    font-size: 0.95em;
  }
  
  /* –§—ñ–∫—Å–∞—Ü—ñ—è "–ª–∏–ø–∫–æ—ó" –∫–æ–ª–æ–Ω–∫–∏ —ñ–º–µ–Ω –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
  .name-cell,
  th.name-column {
    position: sticky;
    left: 0;
    z-index: 5;
  }
  
  /* –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª—ñ–Ω–≥—É –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ */
  .table-container::after {
    content: '‚Üê –ø—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å ‚Üí';
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.8em;
    color: var(--secondary-color);
    opacity: 0.7;
  }
}

/* –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó –¥–ª—è –¥—É–∂–µ –º–∞–ª–µ–Ω—å–∫–∏—Ö –µ–∫—Ä–∞–Ω—ñ–≤ */
@media (max-width: 480px) {
  .container {
    padding: 8px;
    margin: 5px 2px;
  }
  
  h1 {
    font-size: 1.3em;
  }
  
  .clock {
    font-size: 1.3em;
  }
  
  /* –ó–º–µ–Ω—à—É—î–º–æ –≤—ñ–¥—Å—Ç—É–ø–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ */
  th, td {
    padding: 4px 2px;
    font-size: 0.85em;
  }
  
  .name-column {
    width: 100px;
  }
  
  .day-column {
    width: 25px;
  }
  
  input[type="checkbox"] {
    transform: scale(1.1);
  }
  
  /* –ü–æ–∫—Ä–∞—â—É—î–º–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –≤–∏–≥–ª—è–¥ —Å–ø–æ–≤—ñ—â–µ–Ω—å */
  .notification {
    width: 90%;
    left: 5%;
    right: 5%;
    font-size: 0.9em;
    padding: 10px;
    text-align: center;
  }
  
  /* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è */
  .save-indicator {
    width: 25px;
    height: 25px;
    font-size: 0.8em;
  }
}
  </style>
</head>
<body>
  <div class="container">
    <div id="dateDisplay"></div>
    <div class="header">
      <h1>–ö–ª—É–± "–Ø–©–Ü–†–ö–ê" - –û–±–ª—ñ–∫ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ</h1>
      <div class="clock">üïí <span id="clock"></span></div>
    </div>
    
    <div class="month-selector">
      <label for="monthSelect">üìÖ –ú—ñ—Å—è—Ü—å:</label>
      <select id="monthSelect" onchange="changeMonth()">
        <option value="0" data-days="31">–°—ñ—á–µ–Ω—å</option>
        <option value="1" data-days="28">–õ—é—Ç–∏–π</option>
        <option value="2" data-days="31">–ë–µ—Ä–µ–∑–µ–Ω—å</option>
        <option value="3" data-days="30">–ö–≤—ñ—Ç–µ–Ω—å</option>
        <option value="4" data-days="31">–¢—Ä–∞–≤–µ–Ω—å</option>
        <option value="5" data-days="30">–ß–µ—Ä–≤–µ–Ω—å</option>
        <option value="6" data-days="31">–õ–∏–ø–µ–Ω—å</option>
        <option value="7" data-days="31">–°–µ—Ä–ø–µ–Ω—å</option>
        <option value="8" data-days="30">–í–µ—Ä–µ—Å–µ–Ω—å</option>
        <option value="9" data-days="31">–ñ–æ–≤—Ç–µ–Ω—å</option>
        <option value="10" data-days="30">–õ–∏—Å—Ç–æ–ø–∞–¥</option>
        <option value="11" data-days="31">–ì—Ä—É–¥–µ–Ω—å</option>
      </select>
      <input type="number" id="yearInput" min="2020" max="2050" value="2025" style="width: 80px; margin-left: 10px;" onchange="changeMonth()">
    </div>
    
    <div class="price-display">
      <label for="dailyRate">–í–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞ –¥–µ–Ω—å: </label>
      <input type="number" id="dailyRate" value="500" style="width: 100px;" onchange="updateAllTotals()"> –≥—Ä–Ω
    </div>

    <div class="calculator">
      <!-- <h3>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∞—Ä—Ç–æ—Å—Ç—ñ</h3> -->
      <table>
        <!-- <thead>
          <tr>
            <th>–î–Ω—ñ–≤ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ</th>
            <th>–í–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞ –¥–µ–Ω—å</th>
            <th>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞</th>
          </tr>
        </thead> -->
        <tbody>
          <tr>
            <td><input type="number" id="daysAttended" min="0" max="31" value="0" oninput="updateCalculator()"></td>
            <td><input type="number" id="dailyRateCalc" value="500" readonly></td>
            <td><input type="number" id="totalPayment" readonly></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="summary-container">
      <h3>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
      <table>
        <tr>
          <th>–í—Å—å–æ–≥–æ –¥—ñ—Ç–µ–π</th>
          <th>–í—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—å (–±—É–¥. –¥–Ω—ñ)</th>
          <th>–ó–∞–≥–∞–ª–æ–º –¥–æ —Å–ø–ª–∞—Ç–∏</th>
          <th>–ó–∞–≥–∞–ª–æ–º –æ–ø–ª–∞—á–µ–Ω–æ</th>
          <th>–ë–∞–ª–∞–Ω—Å</th>
        </tr>
        <tr>
          <td id="totalChildren">0</td>
          <td id="totalAttendance">0</td>
          <td id="totalDue">0 –≥—Ä–Ω</td>
          <td id="totalPaid">0 –≥—Ä–Ω</td>
          <td id="totalBalance">0 –≥—Ä–Ω</td>
        </tr>
      </table>
    </div>

    <div class="button-group">
      <button onclick="saveTableData()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –¥–∞–Ω—ñ</button>
      <button onclick="clearTableData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –¥–∞–Ω—ñ</button>
      <button onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ –¥–∏—Ç–∏–Ω—É</button>
      <button onclick="removeLastRow()">‚ûñ –í–∏–¥–∞–ª–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫</button>
      <button onclick="exportToPDF()">üìÑ –ï–∫—Å–ø–æ—Ä—Ç –≤ PDF</button>
    </div>

    <div class="table-container">
      <table id="attendanceTable">
        <thead>
          <tr>
            <th class="name-column">–Ü–º'—è –¥–∏—Ç–∏–Ω–∏</th>
            <!-- –î–Ω—ñ –º—ñ—Å—è—Ü—è –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ —á–µ—Ä–µ–∑ JavaScript -->
          </tr>
        </thead>
        <tbody>
          <!-- –†—è–¥–∫–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ —á–µ—Ä–µ–∑ JavaScript -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
    const table = document.getElementById('attendanceTable');
    const DEFAULT_ROWS = 20;
    const MAX_ROWS = 30;
    const DAILY_RATE = 500; // –ë–∞–∑–æ–≤–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞ –¥–µ–Ω—å
    let currentMonthDays = 31;
    let weekendDays = []; // –ú–∞—Å–∏–≤ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–Ω—ñ–≤
    
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    function initPage() {
      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ
      const now = new Date();
      document.getElementById('monthSelect').value = now.getMonth();
      document.getElementById('yearInput').value = now.getFullYear();
      document.getElementById('dailyRate').value = DAILY_RATE;
      document.getElementById('dailyRateCalc').value = DAILY_RATE;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–Ω—ñ–≤ –º—ñ—Å—è—Ü—è
      setupTable();
      
      // –î–æ–¥–∞—î–º–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä—è–¥–∫–∏ –¥–ª—è 20 –¥—ñ—Ç–µ–π
      for (let i = 1; i < DEFAULT_ROWS; i++) {
        addRow();
      }
      
      // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ
      loadTableData();
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
      updateCalculator();
      
      // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≥–æ–¥–∏–Ω–Ω–∏–∫
      updateClock();
      setInterval(updateClock, 1000);
    }
    
    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≥–æ–¥–∏–Ω–Ω–∏–∫–∞
    function updateClock() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
    }
    
    // –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ñ: —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –¥–ª—è –¥–Ω—ñ–≤ —ñ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ —Ä—è–¥–∫–∞
    function setupTable() {
      // –û—Ç—Ä–∏–º—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ —É –º—ñ—Å—è—Ü—ñ
      const monthIndex = parseInt(document.getElementById('monthSelect').value);
      const year = parseInt(document.getElementById('yearInput').value);
      
      // –í–∏–∑–Ω–∞—á–∞—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ —É –º—ñ—Å—è—Ü—ñ
      const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
      currentMonthDays = daysInMonth;
      
      // –û—á–∏—â–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ñ, –∑–∞–ª–∏—à–∞—é—á–∏ —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å (–Ü–º'—è –¥–∏—Ç–∏–Ω–∏)
      const headerRow = table.querySelector('thead tr');
      while (headerRow.children.length > 1) {
        headerRow.removeChild(headerRow.lastChild);
      }
      
      // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–Ω—ñ
      weekendDays = [];
      for (let day = 1; day <= daysInMonth; day++) {
        const date = new Date(year, monthIndex, day);
        const dayOfWeek = date.getDay();
        if (dayOfWeek === 0 || dayOfWeek === 6) { // 0 - –Ω–µ–¥—ñ–ª—è, 6 - —Å—É–±–æ—Ç–∞
          weekendDays.push(day);
        }
      }
      
      // –î–æ–¥–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –¥–Ω—ñ–≤ –º—ñ—Å—è—Ü—è
      for (let day = 1; day <= daysInMonth; day++) {
        const th = document.createElement('th');
        th.className = 'day-column' + (weekendDays.includes(day) ? ' weekend' : '');
        th.textContent = day.toString().padStart(2, '0');
        headerRow.appendChild(th);
      }
      
      // –î–æ–¥–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –ø—ñ–¥—Å—É–º–∫–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤
      const totalTh = document.createElement('th');
      totalTh.className = 'total-column';
      totalTh.textContent = '–í—Å—å–æ–≥–æ';
      headerRow.appendChild(totalTh);
      
      const paymentTh = document.createElement('th');
      paymentTh.className = 'payment-column';
      paymentTh.textContent = '–î–æ —Å–ø–ª–∞—Ç–∏';
      headerRow.appendChild(paymentTh);
      
      const paidTh = document.createElement('th');
      paidTh.className = 'payment-column';
      paidTh.textContent = '–û–ø–ª–∞—á–µ–Ω–æ';
      headerRow.appendChild(paidTh);
      
      const balanceTh = document.createElement('th');
      balanceTh.className = 'balance-column';
      balanceTh.textContent = '–ó–∞–ª–∏—à–æ–∫';
      headerRow.appendChild(balanceTh);
      
      // –û—á–∏—â–∞—î–º–æ —Ç—ñ–ª–æ —Ç–∞–±–ª–∏—Ü—ñ
      const tbody = table.querySelector('tbody');
      while (tbody.firstChild) {
        tbody.removeChild(tbody.firstChild);
      }
      
      // –î–æ–¥–∞—î–º–æ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫
      addRow();
    }
    
    // –ó–º—ñ–Ω–∞ –º—ñ—Å—è—Ü—è —É –≤–∏–±—ñ—Ä–Ω–∏–∫—É
    function changeMonth() {
      setupTable();
      
      // –î–æ–¥–∞—î–º–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä—è–¥–∫–∏ –¥–ª—è 20 –¥—ñ—Ç–µ–π
      for (let i = 1; i < DEFAULT_ROWS; i++) {
        addRow();
      }
      
      loadTableData();
      updateAllTotals();
    }
    
    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
    function updateCalculator() {
      const daysAttended = parseInt(document.getElementById('daysAttended').value) || 0;
      const dailyRate = parseInt(document.getElementById('dailyRate').value) || DAILY_RATE;
      document.getElementById('dailyRateCalc').value = dailyRate;
      document.getElementById('totalPayment').value = daysAttended * dailyRate;
    }
    
    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥—Å—É–º–∫—ñ–≤ –¥–ª—è —Ä—è–¥–∫–∞
    function updateRowTotals(row) {
      const dailyRate = parseInt(document.getElementById('dailyRate').value) || DAILY_RATE;
      const inputs = row.querySelectorAll('input');
      const nameInput = inputs[0];
      
      // –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤—ñ–¥–≤—ñ–¥–∞–Ω–∏—Ö –¥–Ω—ñ–≤ (–∫—Ä—ñ–º –≤–∏—Ö—ñ–¥–Ω–∏—Ö)
      let attendance = 0;
      let totalDue = 0;
      
      // –ü–µ—Ä–µ–±–∏—Ä–∞—î–º–æ –≤—Å—ñ –¥–Ω—ñ –º—ñ—Å—è—Ü—è
      for (let i = 1; i <= currentMonthDays; i++) {
        const checkbox = inputs[i];
        if (checkbox && checkbox.checked) {
          // –Ø–∫—â–æ —Ü–µ –Ω–µ –≤–∏—Ö—ñ–¥–Ω–∏–π –¥–µ–Ω—å, –≤—Ä–∞—Ö–æ–≤—É—î–º–æ –æ–ø–ª–∞—Ç—É
          if (!weekendDays.includes(i)) {
            attendance++;
            totalDue += dailyRate;
          }
        }
      }
      
      // –Ü–Ω–¥–µ–∫—Å–∏ –ø—ñ–¥—Å—É–º–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
      const totalIndex = currentMonthDays + 1;
      const dueIndex = currentMonthDays + 2;
      const paidIndex = currentMonthDays + 3;
      const balanceIndex = currentMonthDays + 4;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –ø—ñ–¥—Å—É–º–∫–æ–≤—ñ –ø–æ–ª—è
      inputs[totalIndex].value = attendance;
      inputs[dueIndex].value = totalDue;
      
      // –Ø–∫—â–æ –ø–æ–ª–µ "–û–ø–ª–∞—á–µ–Ω–æ" –∑–∞–ø–æ–≤–Ω–µ–Ω–µ, —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ –∑–∞–ª–∏—à–æ–∫
      const paidAmount = parseInt(inputs[paidIndex].value) || 0;
      inputs[balanceIndex].value = paidAmount - totalDue;
    }
    
    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥—Å—É–º–∫—ñ–≤ —Ç–∞–±–ª–∏—Ü—ñ —Ç–∞ –∑–∞–≥–∞–ª—å–Ω–∏—Ö —Å—É–º
    function updateAllTotals() {
      const rows = table.querySelectorAll('tbody tr');
      let totalChildren = 0;
      let totalAttendance = 0;
      let totalDueAmount = 0;
      let totalPaidAmount = 0;
      
      rows.forEach(row => {
        updateRowTotals(row);
        
        // –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–∏—Ö —Å—É–º
        const inputs = row.querySelectorAll('input');
        const nameValue = inputs[0].value.trim();
        const totalAttended = parseInt(inputs[currentMonthDays + 1].value) || 0;
        const dueAmount = parseInt(inputs[currentMonthDays + 2].value) || 0;
        const paidAmount = parseInt(inputs[currentMonthDays + 3].value) || 0;
        
        // –Ø–∫—â–æ —Ä—è–¥–æ–∫ –º—ñ—Å—Ç–∏—Ç—å —ñ–º'—è –¥–∏—Ç–∏–Ω–∏, –≤—Ä–∞—Ö–æ–≤—É—î–º–æ –π–æ–≥–æ –≤ –∑–∞–≥–∞–ª—å–Ω—ñ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ
        if (nameValue) {
          totalChildren++;
          totalAttendance += totalAttended;
          totalDueAmount += dueAmount;
          totalPaidAmount += paidAmount;
        }
      });
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      document.getElementById('totalChildren').textContent = totalChildren;
      document.getElementById('totalAttendance').textContent = totalAttendance;
      document.getElementById('totalDue').textContent = totalDueAmount + ' –≥—Ä–Ω';
      document.getElementById('totalPaid').textContent = totalPaidAmount + ' –≥—Ä–Ω';
      document.getElementById('totalBalance').textContent = (totalPaidAmount - totalDueAmount) + ' –≥—Ä–Ω';
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
      updateCalculator();
    }
    
    // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä—è–¥–∫–∞ –¥–ª—è –Ω–æ–≤–æ—ó –¥–∏—Ç–∏–Ω–∏
    function createTableRow() {
      const tr = document.createElement('tr');
      
      // –î–æ–¥–∞—î–º–æ –∫–æ–º—ñ—Ä–∫—É –¥–ª—è —ñ–º–µ–Ω—ñ –∑ –∫–ª–∞—Å–æ–º –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏
      const nameTd = document.createElement('td');
      nameTd.className = 'name-cell'; // –î–æ–¥–∞—î–º–æ –∫–ª–∞—Å –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –∫–æ–º—ñ—Ä–∫–∏
      const nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.placeholder = '–í–≤–µ–¥—ñ—Ç—å —ñ–º\'—è';
      nameTd.appendChild(nameInput);
      tr.appendChild(nameTd);
      
      // –î–æ–¥–∞—î–º–æ –∫–æ–º—ñ—Ä–∫–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –¥–Ω—è –º—ñ—Å—è—Ü—è
      for (let day = 1; day <= currentMonthDays; day++) {
        const td = document.createElement('td');
        if (weekendDays.includes(day)) {
          td.className = 'weekend';
        }
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.dataset.day = day;
        td.appendChild(checkbox);
        tr.appendChild(td);
      }
      
      // –î–æ–¥–∞—î–º–æ –ø—ñ–¥—Å—É–º–∫–æ–≤—ñ –∫–æ–º—ñ—Ä–∫–∏
      // –í—Å—å–æ–≥–æ –¥–Ω—ñ–≤
      const totalTd = document.createElement('td');
      const totalInput = document.createElement('input');
      totalInput.type = 'number';
      totalInput.readOnly = true;
      totalInput.value = '0';
      totalTd.appendChild(totalInput);
      tr.appendChild(totalTd);
      
      // –î–æ —Å–ø–ª–∞—Ç–∏
      const dueTd = document.createElement('td');
      const dueInput = document.createElement('input');
      dueInput.type = 'number';
      dueInput.readOnly = true;
      dueInput.value = '0';
      dueTd.appendChild(dueInput);
      tr.appendChild(dueTd);
      
      // –û–ø–ª–∞—á–µ–Ω–æ
      const paidTd = document.createElement('td');
      const paidInput = document.createElement('input');
      paidInput.type = 'number';
      paidInput.value = '0';
      paidInput.min = '0';
      paidTd.appendChild(paidInput);
      tr.appendChild(paidTd);
      
      // –ó–∞–ª–∏—à–æ–∫
      const balanceTd = document.createElement('td');
      const balanceInput = document.createElement('input');
      balanceInput.type = 'number';
      balanceInput.readOnly = true;
      balanceInput.value = '0';
      balanceTd.appendChild(balanceInput);
      tr.appendChild(balanceTd);
      
      return tr;
    }
    
    // –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—é
    function addRow() {
      const tbody = table.querySelector('tbody');
      if (tbody.children.length >= MAX_ROWS) {
        alert(`–î–æ—Å—è–≥–Ω—É—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ (${MAX_ROWS})`);
        return;
      }
      
      const newRow = createTableRow();
      tbody.appendChild(newRow);
      updateRowTotals(newRow);
      updateAllTotals();
      
      // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞
      const inputs = newRow.querySelectorAll('input');
      inputs.forEach(input => {
        if (input.type === 'checkbox') {
          input.addEventListener('change', () => {
            updateRowTotals(newRow);
            updateAllTotals();
            saveTableData();
          });
        } else if (!input.readOnly) {
          input.addEventListener('input', () => {
            updateRowTotals(newRow);
            updateAllTotals();
            saveTableData();
          });
        }
      });
    }
    
    // –í–∏–¥–∞–ª–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ä—è–¥–∫–∞
    function removeLastRow() {
      const tbody = table.querySelector('tbody');
      if (tbody.children.length <= DEFAULT_ROWS) {
        alert(`–ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ä—è–¥–∫–∏. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤: ${DEFAULT_ROWS}`);
        return;
      }
      
      if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫?')) {
        tbody.removeChild(tbody.lastChild);
        saveTableData();
        updateAllTotals();
      }
    }
    
    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—ñ –≤ localStorage
    function saveTableData() {
      const data = [];
      const monthIndex = document.getElementById('monthSelect').value;
      const year = document.getElementById('yearInput').value;
      const dailyRate = document.getElementById('dailyRate').value;
      const rows = table.querySelectorAll('tbody tr');
      
      rows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const rowData = {
          name: inputs[0].value,
          days: [],
          paid: inputs[currentMonthDays + 3].value
        };
        
        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è –ø–æ –¥–Ω—è—Ö
        for (let i = 1; i <= currentMonthDays; i++) {
          rowData.days.push(inputs[i].checked);
        }
        
        data.push(rowData);
      });
      
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ localStorage
      const key = `club_attendance_${monthIndex}_${year}`;
      localStorage.setItem(key, JSON.stringify(data));
      localStorage.setItem('club_attendance_settings', JSON.stringify({
        dailyRate: dailyRate
      }));
      
      // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
      const savedMsg = document.createElement('div');
      savedMsg.textContent = '–î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ ‚úì';
      savedMsg.style.cssText = 'position: fixed; top: 20px; right: 20px; background-color: #2ecc71; color: white; padding: 10px; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.2);';
      document.body.appendChild(savedMsg);
      
      setTimeout(() => {
        document.body.removeChild(savedMsg);
      }, 2000);
    }
    
    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—ñ –∑ localStorage
    function loadTableData() {
      const monthIndex = document.getElementById('monthSelect').value;
      const year = document.getElementById('yearInput').value;
      const key = `club_attendance_${monthIndex}_${year}`;
      const savedData = JSON.parse(localStorage.getItem(key));
      
      // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      const settings = JSON.parse(localStorage.getItem('club_attendance_settings'));
      if (settings) {
        document.getElementById('dailyRate').value = settings.dailyRate;
        document.getElementById('dailyRateCalc').value = settings.dailyRate;
      }
      
      // –Ø–∫—â–æ –Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø–æ—Ä–æ–∂–Ω—é —Ç–∞–±–ª–∏—Ü—é
      if (!savedData || !Array.isArray(savedData)) {
        return;
      }
      
      // –û—á–∏—â–∞—î–º–æ —Ç–∞–±–ª–∏—Ü—é —ñ –¥–æ–¥–∞—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤
      const tbody = table.querySelector('tbody');
      while (tbody.firstChild) {
        tbody.removeChild(tbody.firstChild);
      }
      
      // –î–æ–¥–∞—î–º–æ —Ä—è–¥–∫–∏ –∑ –¥–∞–Ω–∏–º–∏
      savedData.forEach(rowData => {
        const row = createTableRow();
        tbody.appendChild(row);
        
        const inputs = row.querySelectorAll('input');
        inputs[0].value = rowData.name || '';
        
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —á–µ–∫–±–æ–∫—Å–∏
        if (rowData.days && Array.isArray(rowData.days)) {
          rowData.days.forEach((checked, index) => {
            if (index < currentMonthDays) {
              inputs[index + 1].checked = checked;
            }
          });
        }
        
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –æ–ø–ª–∞—Ç—É
        inputs[currentMonthDays + 3].value = rowData.paid || 0;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –ø—ñ–¥—Å—É–º–∫–∏
        updateRowTotals(row);
        
        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
        inputs.forEach(input => {
          if (input.type === 'checkbox') {
            input.addEventListener('change', () => {
              updateRowTotals(row);
              updateAllTotals();
              saveTableData();
            });
          } else if (!input.readOnly) {
            input.addEventListener('input', () => {
              updateRowTotals(row);
              updateAllTotals();
              saveTableData();
            });
          }
        });
      });
    }
    
    // –û—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
    function clearTableData() {
      if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ?')) {
        const monthIndex = document.getElementById('monthSelect').value;
        const year = document.getElementById('yearInput').value;
        const key = `club_attendance_${monthIndex}_${year}`;
        localStorage.removeItem(key);
        
        // –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é
        setupTable();
        
        // –î–æ–¥–∞—î–º–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä—è–¥–∫–∏ –¥–ª—è 20 –¥—ñ—Ç–µ–π
        for (let i = 1; i < DEFAULT_ROWS; i++) {
          addRow();
        }
        
        updateAllTotals();
      }
    }
    
    // –ï–∫—Å–ø–æ—Ä—Ç –≤ PDF
    function exportToPDF() {
      const monthIndex = parseInt(document.getElementById('monthSelect').value);
      const year = document.getElementById('yearInput').value;
      const monthNames = [
        '–°—ñ—á–µ–Ω—å', '–õ—é—Ç–∏–π', '–ë–µ—Ä–µ–∑–µ–Ω—å', '–ö–≤—ñ—Ç–µ–Ω—å', '–¢—Ä–∞–≤–µ–Ω—å', '–ß–µ—Ä–≤–µ–Ω—å',
        '–õ–∏–ø–µ–Ω—å', '–°–µ—Ä–ø–µ–Ω—å', '–í–µ—Ä–µ—Å–µ–Ω—å', '–ñ–æ–≤—Ç–µ–Ω—å', '–õ–∏—Å—Ç–æ–ø–∞–¥', '–ì—Ä—É–¥–µ–Ω—å'
      ];
      
      alert(`–ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö –∑–∞ ${monthNames[monthIndex]} ${year} –≤ PDF –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó.

–î–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –≤ PDF –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É jsPDF –∞–±–æ —ñ–Ω—à—É –∞–Ω–∞–ª–æ–≥—ñ—á–Ω—É. –í –ø–æ—Ç–æ—á–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è —Å–∏–º—É–ª—é—î—Ç—å—Å—è —Ü–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º.`);
    }
    // –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ–∑ —Ç–∞–±–ª–∏—Ü—ñ —É –º–∞—Å–∏–≤
  function getTableData() {
    const rows = document.querySelectorAll("#attendance-table tbody tr");
    const data = [];

    rows.forEach(row => {
      const name = row.querySelector("td:first-child").textContent.trim();
      const checkboxes = row.querySelectorAll("input[type='checkbox']");
      const values = Array.from(checkboxes).map(cb => cb.checked ? 1 : 0);
      data.push({ name, values });
    });

    return data;
  }

  // –ó–∞–ø–∏—Å –º–∞—Å–∏–≤—É —É URL
  function saveDataToURL() {
    const data = getTableData();
    const jsonString = JSON.stringify(data);
    const encoded = encodeURIComponent(jsonString);
    location.hash = "data=" + encoded;
  }

  // –ß–∏—Ç–∞–Ω–Ω—è –∑ URL
  function loadDataFromURL() {
    const hash = location.hash;
    if (hash.startsWith("#data=")) {
      try {
        const json = decodeURIComponent(hash.slice(6));
        return JSON.parse(json);
      } catch (e) {
        console.error("–ü–æ–º–∏–ª–∫–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è URL:", e);
      }
    }
    return null;
  }

  // –í—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Ç–∞–±–ª–∏—Ü—é
  function populateTableFromData(data) {
    const rows = document.querySelectorAll("#attendance-table tbody tr");

    data.forEach((entry, i) => {
      const row = rows[i];
      if (!row) return;
      const checkboxes = row.querySelectorAll("input[type='checkbox']");
      entry.values.forEach((val, j) => {
        if (checkboxes[j]) {
          checkboxes[j].checked = !!val;
        }
      });
    });
  }

  // –î–æ–¥–∞—î —Å–ª—É—Ö–∞—á—ñ –Ω–∞ –≤—Å—ñ —á–µ–∫–±–æ–∫—Å–∏
  function attachCheckboxListeners() {
    const checkboxes = document.querySelectorAll("#attendance-table input[type='checkbox']");
    checkboxes.forEach(cb => {
      cb.addEventListener("change", saveDataToURL);
    });
  }

  // –ó–∞–ø—É—Å–∫ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
  window.addEventListener("load", () => {
    const data = loadDataFromURL();
    if (data) populateTableFromData(data);
    attachCheckboxListeners();
  });
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    window.addEventListener('load', initPage);

    const now = new Date();
    const formattedDate = now.toLocaleDateString('uk-UA', {
      day: 'numeric',
      month: 'long'
    });

    document.getElementById('dateDisplay').textContent = `–°—å–æ–≥–æ–¥–Ω—ñ: ${formattedDate}`;

    window.onload = initPage;
 // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—ñ –≤ JSON
function tableToJSON() {
  const data = [];
  const monthIndex = document.getElementById('monthSelect').value;
  const year = document.getElementById('yearInput').value;
  const dailyRate = document.getElementById('dailyRate').value;
  const rows = table.querySelectorAll('tbody tr');
  
  rows.forEach(row => {
    const inputs = row.querySelectorAll('input');
    const name = inputs[0].value.trim();
    
    // –Ø–∫—â–æ —Ä—è–¥–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π, –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –π–æ–≥–æ
    if (!name) return;
    
    const rowData = {
      name: name,
      days: [],
      paid: parseInt(inputs[currentMonthDays + 3].value) || 0,
      attendance: parseInt(inputs[currentMonthDays + 1].value) || 0,
      due: parseInt(inputs[currentMonthDays + 2].value) || 0,
      balance: parseInt(inputs[currentMonthDays + 4].value) || 0
    };
    
    // –ó–±–∏—Ä–∞—î–º–æ –¥–∞–Ω—ñ –ø—Ä–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è –ø–æ –¥–Ω—è—Ö
    for (let i = 1; i <= currentMonthDays; i++) {
      rowData.days.push(inputs[i].checked ? 1 : 0);
    }
    
    data.push(rowData);
  });
  
  // –î–æ–¥–∞—î–º–æ –º–µ—Ç–∞–¥–∞–Ω—ñ
  const metadata = {
    month: monthIndex,
    year: year,
    dailyRate: dailyRate,
    weekendDays: weekendDays,
    generatedAt: new Date().toISOString(),
    totalChildren: document.getElementById('totalChildren').textContent,
    totalAttendance: document.getElementById('totalAttendance').textContent,
    totalDue: document.getElementById('totalDue').textContent,
    totalPaid: document.getElementById('totalPaid').textContent,
    totalBalance: document.getElementById('totalBalance').textContent
  };
  
  return {
    metadata: metadata,
    attendanceData: data
  };
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è JSON –¥–∞–Ω–∏—Ö –≤ —Ç–∞–±–ª–∏—Ü—é
function loadJSONToTable(jsonData) {
  if (!jsonData || !jsonData.metadata || !jsonData.attendanceData || !Array.isArray(jsonData.attendanceData)) {
    console.error("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç JSON –¥–∞–Ω–∏—Ö");
    return false;
  }
  
  try {
    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –º–µ—Ç–∞–¥–∞–Ω—ñ
    document.getElementById('monthSelect').value = jsonData.metadata.month;
    document.getElementById('yearInput').value = jsonData.metadata.year;
    document.getElementById('dailyRate').value = jsonData.metadata.dailyRate || DAILY_RATE;
    
    // –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –º—ñ—Å—è—Ü—è
    setupTable();
    
    const tbody = table.querySelector('tbody');
    while (tbody.firstChild) {
      tbody.removeChild(tbody.firstChild);
    }
    
    // –î–æ–¥–∞—î–º–æ —Ä—è–¥–∫–∏ –∑ –¥–∞–Ω–∏–º–∏
    jsonData.attendanceData.forEach(rowData => {
      const row = createTableRow();
      tbody.appendChild(row);
      
      const inputs = row.querySelectorAll('input');
      inputs[0].value = rowData.name || '';
      
      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —á–µ–∫–±–æ–∫—Å–∏ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è
      if (rowData.days && Array.isArray(rowData.days)) {
        rowData.days.forEach((checked, index) => {
          if (index < currentMonthDays) {
            inputs[index + 1].checked = checked === 1;
          }
        });
      }
      
      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –æ–ø–ª–∞—Ç—É
      inputs[currentMonthDays + 3].value = rowData.paid || 0;
      
      // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
      setupRowEventListeners(row);
    });
    
    // –û–Ω–æ–≤–ª—é—î–º–æ –≤—Å—ñ –ø—ñ–¥—Å—É–º–∫–∏
    updateAllTotals();
    return true;
  } catch (error) {
    console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è JSON:", error);
    return false;
  }
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø–æ–¥—ñ–π —Ä—è–¥–∫–∞
function setupRowEventListeners(row) {
  const inputs = row.querySelectorAll('input');
  inputs.forEach(input => {
    if (input.type === 'checkbox') {
      input.addEventListener('change', () => {
        updateRowTotals(row);
        updateAllTotals();
        saveTableData();
      });
    } else if (!input.readOnly) {
      input.addEventListener('input', () => {
        updateRowTotals(row);
        updateAllTotals();
        saveTableData();
      });
    }
  });
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É JSON
function exportToJSON() {
  const jsonData = tableToJSON();
  const jsonString = JSON.stringify(jsonData, null, 2);
  
  // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
  const monthNames = [
    '–°—ñ—á–µ–Ω—å', '–õ—é—Ç–∏–π', '–ë–µ—Ä–µ–∑–µ–Ω—å', '–ö–≤—ñ—Ç–µ–Ω—å', '–¢—Ä–∞–≤–µ–Ω—å', '–ß–µ—Ä–≤–µ–Ω—å',
    '–õ–∏–ø–µ–Ω—å', '–°–µ—Ä–ø–µ–Ω—å', '–í–µ—Ä–µ—Å–µ–Ω—å', '–ñ–æ–≤—Ç–µ–Ω—å', '–õ–∏—Å—Ç–æ–ø–∞–¥', '–ì—Ä—É–¥–µ–Ω—å'
  ];
  const monthIndex = parseInt(document.getElementById('monthSelect').value);
  const year = document.getElementById('yearInput').value;
  
  const filename = `club_attendance_${monthNames[monthIndex]}_${year}.json`;
  
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(jsonString);
  const downloadAnchorNode = document.createElement('a');
  downloadAnchorNode.setAttribute("href", dataStr);
  downloadAnchorNode.setAttribute("download", filename);
  document.body.appendChild(downloadAnchorNode);
  downloadAnchorNode.click();
  downloadAnchorNode.remove();
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É JSON
function importFromJSON() {
  // –°—Ç–≤–æ—Ä—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç input –¥–ª—è –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É
  const fileInput = document.createElement('input');
  fileInput.type = 'file';
  fileInput.accept = 'application/json';
  
  fileInput.onchange = function(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const jsonData = JSON.parse(e.target.result);
        const success = loadJSONToTable(jsonData);
        
        if (success) {
          // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ —Ç–∞–∫–æ–∂ –≤ localStorage
          saveTableData();
          
          // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω–∏–π —ñ–º–ø–æ—Ä—Ç
          showNotification('–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ JSON');
        } else {
          showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö', true);
        }
      } catch (error) {
        console.error("–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É JSON:", error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É JSON —Ñ–∞–π–ª—É', true);
      }
    };
    
    reader.readAsText(file);
  };
  
  fileInput.click();
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
function showNotification(message, isError = false) {
  const notification = document.createElement('div');
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: ${isError ? '#e74c3c' : '#2ecc71'};
    color: white;
    padding: 12px 20px;
    border-radius: 5px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    z-index: 1000;
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.opacity = '0';
    notification.style.transition = 'opacity 0.5s';
    
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 500);
  }, 3000);
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Ö–º–∞—Ä–Ω–µ —Å—Ö–æ–≤–∏—â–µ
function saveToCloud() {
  const jsonData = tableToJSON();
  const jsonString = JSON.stringify(jsonData);
  
  // –¢—É—Ç –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∫—É –¥–∞–Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ fetch –∞–±–æ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏
  // –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
  /*
  fetch('https://your-api-endpoint.com/save', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: jsonString
  })
  .then(response => response.json())
  .then(data => {
    showNotification('–î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ —Ö–º–∞—Ä—ñ');
  })
  .catch(error => {
    showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —Ö–º–∞—Ä—ñ', true);
    console.error('Error:', error);
  });
  */
  
  // –Ü–º—ñ—Ç–∞—Ü—ñ—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —Ö–º–∞—Ä—ñ –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—É
  setTimeout(() => {
    showNotification('–î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ —Ö–º–∞—Ä—ñ (–¥–µ–º–æ)');
  }, 1000);
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
function setupAutoSave(interval = 5 * 60 * 1000) { // –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 5 —Ö–≤–∏–ª–∏–Ω
  setInterval(() => {
    saveTableData();
    // –î–æ–¥–∞—î–º–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É —ñ–Ω–¥–∏–∫–∞—Ü—ñ—é –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
    const saveIndicator = document.createElement('div');
    saveIndicator.textContent = '‚úì';
    saveIndicator.style.cssText = `
      position: fixed;
      bottom: 10px;
      right: 10px;
      background-color: rgba(46, 204, 113, 0.7);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    `;
    
    document.body.appendChild(saveIndicator);
    
    setTimeout(() => {
      document.body.removeChild(saveIndicator);
    }, 1000);
  }, interval);
}

// –û–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ñ
function addJSONButtons() {
  const buttonGroup = document.querySelector('.button-group');
  
  // –ö–Ω–æ–ø–∫–∞ –µ–∫—Å–ø–æ—Ä—Ç—É –≤ JSON
  const exportJSONButton = document.createElement('button');
  exportJSONButton.textContent = 'üì§ –ï–∫—Å–ø–æ—Ä—Ç –≤ JSON';
  exportJSONButton.onclick = exportToJSON;
  buttonGroup.appendChild(exportJSONButton);
  
  // –ö–Ω–æ–ø–∫–∞ —ñ–º–ø–æ—Ä—Ç—É –∑ JSON
  const importJSONButton = document.createElement('button');
  importJSONButton.textContent = 'üì• –Ü–º–ø–æ—Ä—Ç –∑ JSON';
  importJSONButton.onclick = importFromJSON;
  buttonGroup.appendChild(importJSONButton);
  
  // –ö–Ω–æ–ø–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —Ö–º–∞—Ä—ñ (–¥–µ–º–æ)
  const cloudSaveButton = document.createElement('button');
  cloudSaveButton.textContent = '‚òÅÔ∏è –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ —Ö–º–∞—Ä—ñ';
  cloudSaveButton.onclick = saveToCloud;
  buttonGroup.appendChild(cloudSaveButton);
}

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π
function initJSONFeatures() {
  addJSONButtons();
  setupAutoSave();
  
  // –î–æ–¥–∞—î–º–æ —Å–ª—É—Ö–∞—á—ñ –ø–æ–¥—ñ–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ –º—ñ—Å—è—Ü—è
  document.getElementById('monthSelect').addEventListener('change', function() {
    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –º—ñ—Å—è—Ü—è –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é
    saveTableData();
  });
  
  document.getElementById('yearInput').addEventListener('change', function() {
    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ä–æ–∫—É –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é
    saveTableData();
  });
  
  // –ú–æ–¥–∏—Ñ—ñ–∫—É—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
  const originalInitPage = window.initPage;
  window.initPage = function() {
    originalInitPage();
    console.log('JSON —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ');
  };
}

// –ó–∞–ø—É—Å–∫–∞—î–º–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é JSON —Ñ—É–Ω–∫—Ü—ñ–π –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
document.addEventListener('DOMContentLoaded', initJSONFeatures);

// –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∑ –º–æ–±—ñ–ª—å–Ω–∏–º–∏ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏
document.addEventListener('DOMContentLoaded', function() {
  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–∏—Å—Ç—Ä—ñ–π –º–æ–±—ñ–ª—å–Ω–∏–π
  const isMobile = window.innerWidth <= 768;
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Ç–∞–±–ª–∏—Ü–µ—é –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
  function enhanceTableForMobile() {
    const tableContainer = document.querySelector('.table-container');
    
    if (!tableContainer || !isMobile) return;
    
    // –î–æ–¥–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è
    const scrollIndicator = document.createElement('div');
    scrollIndicator.className = 'scroll-indicator';
    scrollIndicator.innerText = '‚Üê –ø—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å ‚Üí';
    scrollIndicator.style.textAlign = 'center';
    scrollIndicator.style.fontSize = '0.8em';
    scrollIndicator.style.color = 'var(--secondary-color)';
    scrollIndicator.style.opacity = '0.7';
    scrollIndicator.style.marginBottom = '10px';
    
    // –í—Å—Ç–∞–≤–ª—è—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è –ø—ñ—Å–ª—è —Ç–∞–±–ª–∏—Ü—ñ
    tableContainer.parentNode.insertBefore(scrollIndicator, tableContainer.nextSibling);
    
    // –ó–Ω–∏–∫–Ω–µ–Ω–Ω—è —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è
    tableContainer.addEventListener('scroll', function() {
      setTimeout(() => {
        scrollIndicator.style.opacity = '0';
        scrollIndicator.style.transition = 'opacity 0.5s';
      }, 2000);
    }, { once: true });
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —à–∏—Ä–∏–Ω–∏ —Ç–∞–±–ª–∏—Ü—ñ —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó —à–∏—Ä–∏–Ω–∏
    const table = tableContainer.querySelector('table');
    if (table) {
      const minWidth = Math.max(500, table.scrollWidth);
      table.style.minWidth = minWidth + 'px';
    }
  }
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–æ—Ä–º–∞–º–∏ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
  function enhanceFormsForMobile() {
    if (!isMobile) return;
    
    // –ó–±—ñ–ª—å—à—É—î–º–æ —Ä–æ–∑–º—ñ—Ä –ø–æ–ª—ñ–≤ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
    const numberInputs = document.querySelectorAll('input[type="number"]');
    numberInputs.forEach(input => {
      input.addEventListener('focus', function() {
        this.style.padding = '8px';
        this.style.fontSize = '16px'; // –û–ø—Ç–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –Ω–∞ iOS
      });
      
      input.addEventListener('blur', function() {
        this.style.padding = '';
        this.style.fontSize = '';
      });
    });
    
    // –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —á–µ–∫–±–æ–∫—Å—ñ–≤ –¥–ª—è —Å–µ–Ω—Å–æ—Ä–Ω–∏—Ö –µ–∫—Ä–∞–Ω—ñ–≤
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      // –°—Ç–≤–æ—Ä—é—î–º–æ –±—ñ–ª—å—à—É –æ–±–ª–∞—Å—Ç—å –Ω–∞–≤–∫–æ–ª–æ —á–µ–∫–±–æ–∫—Å–∞ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è
      const wrapper = document.createElement('div');
      wrapper.style.padding = '5px';
      wrapper.style.display = 'inline-block';
      
      // –ó–∞–º—ñ–Ω—é—î–º–æ —á–µ–∫–±–æ–∫—Å –Ω–∞ –æ–±–≥–æ—Ä—Ç–∫—É
      checkbox.parentNode.insertBefore(wrapper, checkbox);
      wrapper.appendChild(checkbox);
    });
  }
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∫–Ω–æ–ø–æ–∫ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
  function enhanceButtonsForMobile() {
    if (!isMobile) return;
    
    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => {
      // –ó–±—ñ–ª—å—à—É—î–º–æ –≤—ñ–¥—Å—Ç—É–ø–∏ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è
      button.style.padding = '12px 15px';
      button.style.marginBottom = '8px';
      
      // –î–æ–¥–∞—î–º–æ –±—ñ–ª—å—à–µ –≤—ñ–∑—É–∞–ª—å–Ω–æ–≥–æ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ
      button.addEventListener('touchstart', function() {
        this.style.opacity = '0.8';
      });
      
      button.addEventListener('touchend', function() {
        this.style.opacity = '1';
      });
    });
  }
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
  function enhanceModalsForMobile() {
    if (!isMobile) return;
    
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
      const content = modal.querySelector('.modal-content');
      if (content) {
        // –ó–º—ñ–Ω—é—î–º–æ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
        content.style.margin = '5% auto';
        content.style.width = '95%';
        content.style.maxHeight = '90vh';
        content.style.overflow = 'auto';
      }
    });
  }
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
  function enhanceCalculatorForMobile() {
    if (!isMobile) return;
    
    const calculator = document.querySelector('.calculator');
    if (!calculator) return;
    
    // –ü–æ–∫—Ä–∞—â—É—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–ª—ñ–≤ –≤–≤–µ–¥–µ–Ω–Ω—è
    const inputs = calculator.querySelectorAll('input');
    inputs.forEach(input => {
      input.style.width = '100%';
      input.style.maxWidth = '200px';
      input.style.margin = '5px auto';
    });
  }
  
  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–∞—Ç–∏
  function enhanceDateDisplayForMobile() {
    if (!isMobile) return;
    
    const dateDisplay = document.getElementById('dateDisplay');
    if (!dateDisplay) return;
    
    // –°–∫–æ—Ä–æ—á—É—î–º–æ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö, —è–∫—â–æ –≤—ñ–Ω –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥–∏–π
    const text = dateDisplay.innerText;
    if (text.length > 20) {
      // –°–ø—Ä–æ–±—É—î–º–æ —Å–∫–æ—Ä–æ—Ç–∏—Ç–∏ –Ω–∞–∑–≤–∏ –º—ñ—Å—è—Ü—ñ–≤ –∞–±–æ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏
      dateDisplay.style.fontSize = '0.9em';
    }
  }
  
  // –í–∏–∫–ª–∏–∫–∞—î–º–æ –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö
  function initMobileOptimizations() {
    enhanceTableForMobile();
    enhanceFormsForMobile();
    enhanceButtonsForMobile();
    enhanceModalsForMobile();
    enhanceCalculatorForMobile();
    enhanceDateDisplayForMobile();
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –æ—Ä—ñ—î–Ω—Ç–∞—Ü—ñ—ó –µ–∫—Ä–∞–Ω—É
    window.addEventListener('orientationchange', function() {
      // –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –ø–µ—Ä–µ–±—É–¥—É–≤–∞—Ç–∏ –≤–µ—Ä—Å—Ç–∫—É –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –æ—Ä—ñ—î–Ω—Ç–∞—Ü—ñ—ó
      setTimeout(() => {
        enhanceTableForMobile();
        enhanceModalsForMobile();
      }, 300);
    });
  }
  
  // –ó–∞–ø—É—Å–∫–∞—î–º–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—é –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
  if (isMobile) {
    initMobileOptimizations();
    
    // –î–æ–¥–∞—î–º–æ –º–µ—Ç–∞-—Ç–µ–≥ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
    const meta = document.createElement('meta');
    meta.name = 'viewport';
    meta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
    document.head.appendChild(meta);
  }
});
  </script>
</body>
</html>
